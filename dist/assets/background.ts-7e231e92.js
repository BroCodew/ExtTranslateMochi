try{chrome.tabs.onUpdated.addListener((t,o,n)=>{console.log(`Change URL: ${n.url}`)}),chrome.bookmarks.getRecent(10,t=>{console.log("bookmarks:",t)}),chrome.commands.onCommand.addListener(t=>{console.log("lets reload"),console.log(t),t.includes("+B")&&chrome.runtime.reload()}),(async()=>{const[t]=await chrome.tabs.query({active:!0,lastFocusedWindow:!0});console.log("tabgggggg",t)})();const i=async t=>{try{var o=new Headers,n={method:"GET",headers:o,redirect:"follow"};let c=await(await fetch("https://www.facebook.com/ajax/bootloader-endpoint/?modules=AdsCanvasComposerDialog.react",n)).text();var a=c.substring(c.indexOf('"access_token"')+16),d=a.substring(a.indexOf('"')),g=a.substring(0,a.length-d.length),s=c.substring(c.indexOf('"token"')+10),h=s.substring(s.indexOf('"')),_=s.substring(0,s.length-h.length);console.log("tokendtsgtokendtsgtokendtsg",_);let e=await(await fetch("https://graph.facebook.com/v16.0/act_"+t+"?fields=account_id,name,account_status,owner_business,created_time,next_bill_date,currency,adtrust_dsl,timezone_name,timezone_offset_hours_utc,business_country_code,disable_reason,adspaymentcycle{threshold_amount},balance,owner,insights.date_preset(maximum){spend}&access_token="+g)).json(),l={id:e.account_id,name:e.name,accountStatus:e.account_status,balance:e.balance,currentThreshold:e.adspaymentcycle?e.adspaymentcycle.data[0].threshold_amount:"",amountSpent:e.insights?e.insights.data[0].spend:"0",createdTime:e.created_time,nextBillDate:e.next_bill_date,timezoneName:e.timezone_name+" | "+(e.timezone_offset_hours_utc>=0?"+"+e.timezone_offset_hours_utc:e.timezone_offset_hours_utc),limit:e.adtrust_dsl,currency:e.currency,disableReason:e.disable_reason,countryCode:e.business_country_code??"",role:e.userpermissions?e.userpermissions.data[0].role:"",ownerBusiness:e.owner_business?e.owner_business.id:null,accountType:e.ownerBusiness!==null?"Bussiness":"Cá nhân",hiddenAdmin:0};var r=await m(t);return l.hiddenAdmin=r?r==null?void 0:r.length:0,console.log("adaccountsadaccountsadaccounts",l),l}catch(u){console.log(u)}},m=async t=>{var o;try{return(o=(await(await fetch("https://www.facebook.com/ads/manager/account_settings/information/?act="+t)).text()).match(/\b(\d+)\,(name:null)\b/g))==null?void 0:o.map(d=>({id:d.replace(",name:null",""),name:"Người dùng Facebook"}))}catch(n){return console.log(n),[]}};chrome.runtime.onMessage.addListener((t,o,n)=>((async()=>{var a=await i(t);n(a)})(),!0)),console.log("this is background service worker")}catch(i){console.log(i)}
